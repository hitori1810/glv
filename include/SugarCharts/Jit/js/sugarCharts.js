function loadSugarChart(chartId,jsonFilename,css,chartConfig,params,callback){if(this.chartObject="",null==document.getElementById(chartId))return!1;var labelType="Native",useGradients=!1,animate=!1,that=this,contentEl="content",minColumnWidth=40;switch(params=params?params:{},contentEl=params.contentEl||contentEl,minColumnWidth=params.minColumnWidth||minColumnWidth,chartConfig.chartType){case"barChart":SUGAR.charts.get(jsonFilename,params,function(data){function fixChartContainer(e,t){var a=YAHOO.util.Dom.getElementsByClassName("chartCanvas","div"),l=YAHOO.util.Dom.getElementsByClassName("chartContainer","div"),i=YAHOO.util.Dom.getRegion(contentEl);if(l.length>0&&a.length>0&&i&&i.width){var n=t*parseInt(minColumnWidth,10);l=YAHOO.util.Dom.get(l[0]),a=YAHOO.util.Dom.get(a[0]),n>i.width?(YAHOO.util.Dom.setStyle(l,"width",i.width+"px"),YAHOO.util.Dom.setStyle(a,"width",n+"px")):(YAHOO.util.Dom.setStyle(l,"width",i.width+"px"),YAHOO.util.Dom.setStyle(a,"width",i.width+"px"))}e||YAHOO.util.Event.addListener(window,"resize",fixChartContainer,json.values.length)}if(SUGAR.charts.isDataEmpty(data)){var json=data,properties=$jit.util.splat(data.properties)[0],marginBottom="vertical"==chartConfig.orientation&&data.values.length>8?80:20;"vertical"==chartConfig.orientation&&fixChartContainer(null,json.values.length);var barChart=new $jit.BarChart({injectInto:chartId,animate:animate,nodeCount:data.values.length,renderBackground:"jpg"==chartConfig.imageExportType?!0:!1,dataPointSize:chartConfig.dataPointSize,backgroundColor:"rgb(255,255,255)",colorStop1:"rgba(255,255,255,.8)",colorStop2:"rgba(255,255,255,0)",shadow:{enable:!1,size:2},orientation:chartConfig.orientation,hoveredColor:!1,Title:{text:properties.title,size:16,color:"#444444",offset:20},Subtitle:{text:properties.subtitle,size:11,color:css.color,offset:20},Ticks:{enable:!0,color:css.gridLineColor},barsOffset:"vertical"==chartConfig.orientation?20:20,Margin:{top:20,left:30,right:20,bottom:marginBottom},ScrollNote:{text:chartConfig.scroll&&$jit.util.isTouchScreen()?"Use two fingers to scroll":"",size:12},Events:{enable:!0,onClick:function(e){e&&!$jit.util.isTouchScreen()&&void 0!=e.link&&"undefined"!=e.link&&""!=e.link&&(window.location.href=e.link)}},labelOffset:5,type:useGradients?chartConfig.barType+":gradient":chartConfig.barType,showAggregates:void 0!=chartConfig.showAggregates?chartConfig.showAggregates:!0,showNodeLabels:void 0!=chartConfig.showNodeLabels?chartConfig.showNodeLabels:!0,segmentStacked:void 0!=chartConfig.segmentStacked?chartConfig.segmentStacked:!1,showLabels:!0,Label:{type:labelType,size:12,family:css["font-family"],color:css.color,colorAlt:"#ffffff"},Tips:{enable:!0,onShow:function(tip,elem){"marker"==elem.type?tip.innerHTML="<b>"+elem.name+"</b>: "+elem.valuelabel:(drillDown=void 0!=elem.link&&""!=elem.link?$jit.util.isTouchScreen()?"<br><a href='"+elem.link+"'>"+SUGAR.language.get("app_strings","LBL_CLICK_TO_DRILLDOWN")+"</a>":"<br>"+SUGAR.language.get("app_strings","LBL_CLICK_TO_DRILLDOWN"):"",value="undefined"!=elem.valuelabel&&void 0!=elem.valuelabel&&""!=elem.valuelabel?"elem.valuelabel":"elem.value",eval(void 0!=properties.label_name&&""!=properties.label_name?"tip.innerHTML = properties.label_name + ': <b>' + elem."+chartConfig.tip+" + '</b><br> '+properties.value_name+': <b>' + "+value+" + '</b>' + drillDown":"tip.innerHTML = '<b>' + elem."+chartConfig.tip+" + '</b>: ' + "+value+" + ' '+ drillDown"))}}});barChart.loadJSON(data);var list=SUGAR.charts.generateLegend(barChart,chartId);$jit.util.saveImageTest(chartId,jsonFilename,chartConfig.imageExportType,chartConfig.saveImageTo),SUGAR.charts.trackWindowResize(barChart,chartId,data),barChart.json=json,that.chartObject=barChart,SUGAR.charts.setChartObject(barChart)}SUGAR.charts.callback(callback)});break;case"lineChart":SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var properties=$jit.util.splat(data.properties)[0],lineChart=new $jit.LineChart({injectInto:chartId,animate:animate,renderBackground:"jpg"==chartConfig.imageExportType?!0:!1,backgroundColor:"rgb(255,255,255)",colorStop1:"rgba(255,255,255,.8)",colorStop2:"rgba(255,255,255,0)",selectOnHover:!1,Title:{text:properties.title,size:16,color:"#444444",offset:20},Subtitle:{text:properties.subtitle,size:11,color:css.color,offset:20},Ticks:{enable:!0,color:css.gridLineColor},Margin:{top:20,left:40,right:40,bottom:20},Events:{enable:!0,onClick:function(e){e&&!$jit.util.isTouchScreen()&&void 0!=e.link&&"undefined"!=e.link&&""!=e.link&&(window.location.href=e.link)}},labelOffset:5,type:useGradients?chartConfig.lineType+":gradient":chartConfig.lineType,showAggregates:!0,showLabels:!0,Label:{type:labelType,size:12,family:css["font-family"],color:css.color,colorAlt:"#ffffff"},Tips:{enable:!0,onShow:function(tip,elem){if(drillDown=void 0!=elem.link&&""!=elem.link?$jit.util.isTouchScreen()?"<br><a href='"+elem.link+"'>"+SUGAR.language.get("app_strings","LBL_CLICK_TO_DRILLDOWN")+"</a>":"<br>"+SUGAR.language.get("app_strings","LBL_CLICK_TO_DRILLDOWN"):"","undefined"!=elem.valuelabel&&void 0!=elem.valuelabel&&""!=elem.valuelabel)var value="elem.valuelabel";else var value="elem.value";if(elem.collision){eval("var name = elem."+chartConfig.tip+";");for(var content="<table>",i=0;i<name.length;i++)content+="<tr><td><b>"+name[i]+"</b>:</td><td> "+elem.value[i]+" - "+elem.percentage[i]+"%</td></tr>";content+="</table>",tip.innerHTML=content}else eval("tip.innerHTML = '<b>' + elem."+chartConfig.tip+" + '</b>: ' + "+value+" + ' '+ drillDown")}}});lineChart.loadJSON(data);var list=SUGAR.charts.generateLegend(lineChart,chartId);$jit.util.saveImageTest(chartId,jsonFilename,chartConfig.imageExportType),SUGAR.charts.trackWindowResize(lineChart,chartId,data),that.chartObject=lineChart}SUGAR.charts.callback(callback)});break;case"pieChart":SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var properties=$jit.util.splat(data.properties)[0],pieChart=new $jit.PieChart({injectInto:chartId,animate:animate,renderBackground:"jpg"==chartConfig.imageExportType?!0:!1,backgroundColor:"rgb(255,255,255)",colorStop1:"rgba(255,255,255,.8)",colorStop2:"rgba(255,255,255,0)",labelType:properties.labels,hoveredColor:!1,offset:50,sliceOffset:0,labelOffset:30,type:useGradients?chartConfig.pieType+":gradient":chartConfig.pieType,showLabels:!0,Title:{text:properties.title,size:16,color:"#444444",offset:20},Subtitle:{text:properties.subtitle,size:11,color:css.color,offset:20},Margin:{top:20,left:20,right:20,bottom:20},Events:{enable:!0,onClick:function(e){e&&!$jit.util.isTouchScreen()&&void 0!=e.link&&"undefined"!=e.link&&""!=e.link&&(window.location.href=e.link)}},Label:{type:labelType,size:13,family:css["font-family"],color:css.color},Tips:{enable:!0,onShow:function(tip,elem){drillDown=void 0!=elem.link&&""!=elem.link?$jit.util.isTouchScreen()?"<br><a href='"+elem.link+"'>"+SUGAR.language.get("app_strings","LBL_CLICK_TO_DRILLDOWN")+"</a>":"<br>"+SUGAR.language.get("app_strings","LBL_CLICK_TO_DRILLDOWN"):"",value="undefined"!=elem.valuelabel&&void 0!=elem.valuelabel&&""!=elem.valuelabel?"elem.valuelabel":"elem.value",eval("tip.innerHTML = '<b>' + elem.label + '</b>: ' + "+value+" + ' '+ drillDown")}}});pieChart.loadJSON(data);var list=SUGAR.charts.generateLegend(pieChart,chartId);$jit.util.saveImageTest(chartId,jsonFilename,chartConfig.imageExportType),SUGAR.charts.trackWindowResize(pieChart,chartId,data),that.chartObject=pieChart}SUGAR.charts.callback(callback)});break;case"funnelChart":SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var properties=$jit.util.splat(data.properties)[0],funnelChart=new $jit.FunnelChart({injectInto:chartId,animate:animate,renderBackground:"jpg"==chartConfig.imageExportType?!0:!1,backgroundColor:"rgb(255,255,255)",colorStop1:"rgba(255,255,255,.8)",colorStop2:"rgba(255,255,255,0)",orientation:"vertical",hoveredColor:!1,Title:{text:properties.title,size:16,color:"#444444",offset:20},Subtitle:{text:properties.subtitle,size:11,color:css.color,offset:20},segmentOffset:20,Margin:{top:20,left:20,right:20,bottom:20},Events:{enable:!0,onClick:function(e){e&&!$jit.util.isTouchScreen()&&void 0!=e.link&&"undefined"!=e.link&&""!=e.link&&(window.location.href=e.link)}},labelOffset:10,type:useGradients?chartConfig.funnelType+":gradient":chartConfig.funnelType,showAggregates:!0,showLabels:!0,Label:{type:labelType,size:12,family:css["font-family"],color:css.color,colorAlt:"#ffffff"},Tips:{enable:!0,onShow:function(tip,elem){drillDown=void 0!=elem.link&&""!=elem.link?$jit.util.isTouchScreen()?"<br><a href='"+elem.link+"'>"+SUGAR.language.get("app_strings","LBL_CLICK_TO_DRILLDOWN")+"</a>":"<br>"+SUGAR.language.get("app_strings","LBL_CLICK_TO_DRILLDOWN"):"",value="undefined"!=elem.valuelabel&&void 0!=elem.valuelabel&&""!=elem.valuelabel?"elem.valuelabel":"elem.value",eval("tip.innerHTML = '<b>' + elem."+chartConfig.tip+" + '</b>: ' + "+value+" + ' '+ drillDown")}}});funnelChart.loadJSON(data);var list=SUGAR.charts.generateLegend(funnelChart,chartId);$jit.util.saveImageTest(chartId,jsonFilename,chartConfig.imageExportType),SUGAR.charts.trackWindowResize(funnelChart,chartId,data),that.chartObject=funnelChart}SUGAR.charts.callback(callback)});break;case"gaugeChart":SUGAR.charts.get(jsonFilename,params,function(data){if(SUGAR.charts.isDataEmpty(data)){var properties=$jit.util.splat(data.properties)[0],gaugeChart=new $jit.GaugeChart({injectInto:chartId,animate:animate,renderBackground:"jpg"==chartConfig.imageExportType?!0:!1,backgroundColor:"rgb(255,255,255)",colorStop1:"rgba(255,255,255,.8)",colorStop2:"rgba(255,255,255,0)",labelType:properties.labels,hoveredColor:!1,Title:{text:properties.title,size:16,color:"#444444",offset:20},Subtitle:{text:properties.subtitle,size:11,color:css.color,offset:5},offset:20,gaugeStyle:{backgroundColor:"#aaaaaa",borderColor:"#999999",needleColor:"rgba(255,0,0,.8)",borderSize:4,positionFontSize:24,positionOffset:2},type:useGradients?chartConfig.gaugeType+":gradient":chartConfig.gaugeType,showLabels:!0,Events:{enable:!0,onClick:function(e){e&&!$jit.util.isTouchScreen()&&void 0!=e.link&&"undefined"!=e.link&&""!=e.link&&(window.location.href=e.link)}},Label:{type:labelType,size:12,family:css["font-family"],color:css.color},Tips:{enable:!0,onShow:function(tip,elem){drillDown=void 0!=elem.link&&""!=elem.link?$jit.util.isTouchScreen()?"<br><a href='"+elem.link+"'>Click to drilldown</a>":"<br>Click to drilldown":"",value="undefined"!=elem.valuelabel&&void 0!=elem.valuelabel&&""!=elem.valuelabel?"elem.valuelabel":"elem.value",eval("tip.innerHTML = '<b>' + elem.label + '</b>: ' + "+value+" + drillDown")}}});gaugeChart.loadJSON(data);var list=SUGAR.charts.generateLegend(gaugeChart,chartId);$jit.util.saveImageTest(chartId,jsonFilename,chartConfig.imageExportType),SUGAR.charts.trackWindowResize(gaugeChart,chartId,data),that.chartObject=gaugeChart}SUGAR.charts.callback(callback)})}}function updateChart(e,t,a){a=a?a:{},SUGAR.charts.get(e,a,function(e){SUGAR.charts.isDataEmpty(e)&&(t.busy=!1,t.updateJSON(e))})}function swapChart(e,t,a,l){$("#"+e).empty(),$("#legend"+e).empty(),$("#tiptip_holder").empty();var i=new loadSugarChart(e,t,a,l);return i}!function(e){"undefined"!=typeof SUGAR&&SUGAR||(SUGAR={}),SUGAR.charts={chart:null,callback:function(e){e&&e(this.chart)},setChartObject:function(e){this.chart=e},generateLegend:function(t,a){var l=$jit.id("legend"+a),i=t.getLegend();if("undefined"!=typeof i.wmlegend&&i.wmlegend.name.length>0)var n="<div class='col'>";else var n="<div class='row'>";for(var r=0;r<i.name.length;r++)void 0!=i.name[r]&&(n+="<div class='legendGroup'>",n+="<div class='query-color' style='background-color:"+i.color[r]+"'></div>",n+="<div class='label'>",n+=i.name[r],n+="</div>",n+="</div>");if(n+="</div>","undefined"!=typeof i.wmlegend&&i.wmlegend.name.length>0){n+="<div class='col2'>";for(var r=0;r<i.wmlegend.name.length;r++)n+="<div class='legendGroup'>",n+="<div class='waterMark  "+i.wmlegend.type[r]+"' style='background-color: "+i.wmlegend.color[r]+";'></div>",n+="<div class='label'>"+i.wmlegend.name[r]+"</div>",n+="</div>";n+="</div>"}return l.innerHTML=n,jQuery("#legend"+a).ready(function(){var t=jQuery("#"+a).width();t-=20,e("#legend"+a).width(t);var l=new Array;if("undefined"!=typeof i.wmlegend&&i.wmlegend.name.length>0)var n=".col .legendGroup";else var n=".row .legendGroup";e(n).each(function(t){l[t]=e(this).width()});var r=Math.max.apply(Math,l);e(n).width(r+2)}),l},get:function(t,a,l){var i={r:(new Date).getTime()};e.extend(i,a),e.ajax({url:t,data:i,dataType:"json",async:!1,success:l})},isDataEmpty:function(e){return void 0!==e&&"No Data"!==e&&""!==e?!0:!1},trackWindowResize:function(t,a,l){var i,n=500,r=document.documentElement.scrollWidth,o=document.getElementById(a),s=document.getElementById(a+"-canvaswidget");e(window).resize(function(){i&&clearTimeout(i),i=setTimeout(function(){var i=document.documentElement.scrollWidth;i!=r&&(s.style.display="none",setTimeout(function(){var n=o.offsetWidth,c=n-20;e("#legend"+a).width(c),s.style.display="",t.resizeGraph(l,n),r=i},0))},n)})},update:function(e,t,a,l){var i=this;a=a?a:{},i.chart=e,this.get(t,a,function(e){i.isDataEmpty(e)&&(i.chart.busy=!1,i.chart.updateJSON(e),i.callback(l))})}}}(jQuery);