
function enhanceACLForm(){var header=$('#ACLEditView_Access_Header');var table=header.closest('table');var firstRow=header.next('tr');header.find('td').each(function(i){if(i!=0){var perms=firstRow.find('td').eq(i).find('select').html();var massUpdatePerms='<select class="massUpdatePerms" style="display:none">'+perms+'</select>';$(this).append(massUpdatePerms);}});$('#ACLEditView_Access_Header').find('td').find('div').click(function(){$(this).hide();$(this).next('.massUpdatePerms').show();});$('#ACLEditView_Access_Header').find('.massUpdatePerms').live('blur',function(){var selectedVal=$(this).val();var colIndex=header.find('td').index($(this).closest('td'));table.find('tr').not(header).find('td:nth('+colIndex+')').each(function(){$(this).find('select:not(:disabled)').val(selectedVal).trigger('blur');});$(this).prev('div').show();$(this).hide();});freezeHeader();}
SUGAR.util.doWhen(function(){return typeof aclviewer!=="undefined";},function(){aclviewer.display=function(o){aclviewer.lastDisplay='';ajaxStatus.flashStatus(SUGAR.language.get('ACLRoles','LBL_DONE'));document.getElementById('category_data').innerHTML=o.responseText;enhanceACLForm();}});function freezeHeader(){var header=$('#ACLEditView_Access_Header');var table=header.closest('table');table.prepend('<thead></thead>');table.find('thead').append(header);table.freezeHeader();$(window).resize(function(){resizeFrozenHeader(table);});$(window).scroll(function(){var menuHeight=$('#dcmenu').height();var frozenHeaderHolder=$('#ACLEditView_Access_Header').closest('div[id*="hdtbl"]');frozenHeaderHolder.css({'top':menuHeight+'px'});frozenHeaderHolder.find('td').click(function(){$(window).scrollTop(table.offset().top-menuHeight);var id=$(this).attr('id');table.find('thead').find('td#'+id).find('div').trigger('click');});resizeFrozenHeader(table);});}
function resizeFrozenHeader(table){$('div[id*="hdtbl"]').find('#ACLEditView_Access_Header').find('td').each(function(){var id=$(this).attr('id');var width=table.find('thead').find('td#'+id).width();$(this).width(width);});}
$(function(){enhanceACLForm();});